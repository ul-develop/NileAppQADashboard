(this.webpackJsonpnilehome=this.webpackJsonpnilehome||[]).push([[16],{1576:function(e,t,a){"use strict";a.r(t);var n,r,c=a(112),o=a(68),i=a(0),l=a.n(i),s=a(402),u=a(1463),d=a(1446),m=a(21),p=a.n(m),f=a(1356),b=a(73),g=a(27),v=Object(f.a)((function(e){return{cell:{paddingTop:e.spacing(1)},today:{backgroundColor:Object(b.a)(e.palette.primary.main,.16)}}})),h=function(e){var t=v(),a=e.today;return i.createElement(d.h.DayScaleCell,Object.assign({},e,{className:Object(g.a)(t.cell,Object(c.a)({},t.today,a))}))},O=a(151),y=a(182),E=a(183),j=a(171),k=a.n(j),x="Something went wrong",D="".concat("MM-DD-YYYY"," HH:mm:ss"),C=function(e){var t=e.config,a=e.dateString,n=e.key,r=p()(t,n)||"";return k()("".concat(a," ").concat(r),D)},w=function(e){var t=e.dateString,a=e.config,n=function(e){return new Date(e).toLocaleString("en-us",{weekday:"short"}).toLowerCase()}(t),r=k()(t);if(function(e){return k()().isSame(e,"day")}(r))return!1;if(function(e){return k()().diff(e,"hours")>0}(r))return!1;if(!function(e){var t=e.dateName,a=e.config;return p()(a,"".concat(t,"Active"))||!1}({dateName:n,config:a}))return!1;var c=r.format("MM-DD-YYYY");return!!function(e){var t=e.config,a=e.currentMoment,n=e.currentDate,r=e.dateName,c=C({config:t,dateString:n,key:"".concat(r,"Start")}),o=C({config:t,dateString:n,key:"".concat(r,"End")});return a.isSameOrAfter(c)&&a.isSameOrBefore(o)}({config:a,currentMoment:r,currentDate:c,dateName:n})&&!function(e){var t=e.config,a=e.currentMoment,n=e.currentDate,r=C({config:t,dateString:n,key:"breakStart"}),c=C({config:t,dateString:n,key:"breakEnd"});return a.isSameOrAfter(r)&&a.isSameOrBefore(c)}({config:a,currentMoment:r,currentDate:c})},S=function(e){var t=e.startDate,a=e.endDate;return{displayDate:k()(t).format("dddd, MMMM DD, YYYY"),displayTime:"".concat(k()(t).format("hh:mm A")," - ").concat(k()(a).format("hh:mm A"))}},I=Object(f.a)((function(e){return{disableCell:{background:"linear-gradient(-45deg,".concat(e.palette.action.disabledBackground," 10%,transparent 10%,transparent 50%,").concat(e.palette.action.disabledBackground," 50%,").concat(e.palette.action.disabledBackground," 60%,transparent 60%,transparent)"),backgroundSize:"8px 8px",pointerEvents:"none"}}})),L=Object(y.a)({timeConfig:function(e){return p()(e,["calendar","config","times"])}}),T=Object(O.connect)(L,void 0)(Object(E.a)((function(e){var t=I(),a=e.startDate,n=e.timeConfig;return i.createElement(d.h.TimeTableCell,Object.assign({},e,{className:Object(g.a)(Object(c.a)({},t.disableCell,!w({dateString:a,config:n})))}))}))),N=a(269),M=["children"],q=Object(f.a)((function(e){return{appointment:{backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.main}}}})),B=function(e){var t=e.children,a=Object(N.a)(e,M),n=q();return i.createElement(d.c.Appointment,Object.assign({},a,{className:n.appointment}),t)},Y=a(240),A=a(1573),R=a(1574),F=Object(f.a)((function(e){return{wrapper:{padding:e.spacing(2),paddingTop:0},section:{marginBottom:e.spacing(1)}}})),P=function(e){var t=e.appointmentData,a=F(),n=S(t),r=n.displayDate,c=n.displayTime;return i.createElement(s.a,{className:a.wrapper},i.createElement(Y.a,{variant:"h3",color:"primary",className:a.section},p()(t,"title","")),i.createElement("div",{className:a.section},i.createElement(Y.a,{variant:"h5"},i.createElement(A.a,null)," ",r)),i.createElement("div",null,i.createElement(Y.a,{variant:"h5"},i.createElement(R.a,null)," ",c)))},H=a(60),W=a.n(H),U=a(201),V=function(e){return{type:U.a.setConfig,payload:e}},z=function(e){return{type:U.a.setError,payload:e}},G=function(e){return{type:U.a.setIsLoading,payload:e}},_=a(1452),J={setStartOfWeek:function(e){return{type:U.a.setStartOfWeek,payload:e}},setEndOfWeek:function(e){return{type:U.a.setEndOfWeek,payload:e}}},K=Object(O.connect)(void 0,J)(Object(E.a)((function(e){var t=e.setStartOfWeek,a=e.setEndOfWeek;return l.a.createElement(_.f,{name:"IntegratedDates"},l.a.createElement(_.e,{name:"startViewDate",computed:function(e){var a=e.startViewDate;return t(a),a}}),l.a.createElement(_.e,{name:"endViewDate",computed:function(e){var t=e.endViewDate;return a(t),t}}))}))),X=a(138),Z=a(124),Q=a(10),$=a.n(Q),ee=a(28),te=a(9),ae=a(11),ne=a(13),re=a(12),ce=a(4),oe=a(95),ie=a.n(oe),le=a(411),se=function(){function e(){Object(te.a)(this,e),this.baseURL="".concat("https://api.youcanbook.me/v1","/").concat("61dd0812-4dfe-4a42-ade9-c3565ec2a9a6","/"),this.cancelToken=null}return Object(ae.a)(e,[{key:"cancel",value:function(){null!==this.cancelToken&&this.cancelToken()}},{key:"axios",value:function(e){var t=e.method,a=e.baseURL,n=void 0===a?this.baseURL:a,r=e.url,c=e.data,o=e.params,i=e.headers,l=void 0===i?{}:i,s=e.needResHeaders,u=void 0!==s&&s,d=this,m=ie.a.CancelToken;return new Promise((function(e,a){var i={method:t,url:r,baseURL:n,timeout:3e4,params:o,data:c,headers:Object(ce.a)(Object(ce.a)({},l),{},{Authorization:le.b}),cancelToken:new m((function(e){d.cancelToken=e}))};ie.a.request(i).then((function(t){var a="object"===typeof t.data?t.data:JSON.parse(t.data);e(u?{data:a,headers:t.headers}:a)}),(function(e){var t=p()(e,["response","status"]),n=p()(e,["response","data","message"]),r=p()(e,["response","data","errors"]);a({status:t,message:n,errors:r})}))}))}}]),e}(),ue=new(function(e){Object(ne.a)(a,e);var t=Object(re.a)(a);function a(){return Object(te.a)(this,a),t.apply(this,arguments)}return Object(ae.a)(a,[{key:"getProfileById",value:function(e){var t=e.id,a=e.fields;return t?this.axios({method:"GET",url:"".concat(le.a.PROFILES,"/").concat(t),params:{fields:a}}):{}}}]),a}(se)),de=a(152),me=a(1523),pe=a.n(me),fe=function(e){Object(ne.a)(a,e);var t=Object(re.a)(a);function a(){return Object(te.a)(this,a),t.apply(this,arguments)}return Object(ae.a)(a,[{key:"createBooking",value:function(){var e=Object(ee.a)($.a.mark((function e(t){var a,n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.profileId,n=t.data,e.abrupt("return",this.axios({method:"POST",url:"".concat(le.a.PROFILES,"/").concat(a,"/").concat(le.a.BOOKINGS),data:Object(ce.a)({},n)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBookings",value:function(){var e=Object(ee.a)($.a.mark((function e(t){var a,n,r,c,o,i,l,s,u,d;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.profileId,n=t.from,r=t.to,a){e.next=3;break}return e.abrupt("return",{});case 3:c=!0,o="",i=[];case 6:if(!c){e.next=25;break}if(o){e.next=13;break}return e.next=10,this.axios({method:"GET",url:"".concat(le.a.PROFILES,"/").concat(a,"/").concat(le.a.BOOKINGS),params:{fields:"id,startsAt,endsAt,answers,answers.*",jumpToDate:k()(n).format("YYYY-MM-DD")},needResHeaders:!0});case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,this.axios({method:"GET",url:o,needResHeaders:!0});case 15:e.t0=e.sent;case 16:l=e.t0,s=p()(l,["headers","link"],""),o=p()(pe()(s),["next","url"],""),u=p()(l,["data"]),i=[].concat(Object(de.a)(i),Object(de.a)(u)),d=p()(u,[u.length-1,"startsAt"],""),c=o&&k()(d).isBefore(r),e.next=6;break;case 25:return e.abrupt("return",ge(i));case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(se),be=function(e){var t=p()(e,["answers"],[]).filter((function(e){return"EMAIL"===e.code}))[0];return p()(t,"string","")},ge=function(e){return e.map((function(e){return{title:be(e),id:p()(e,"id"),startDate:p()(e,"startsAt"),endDate:p()(e,"endsAt")}}))},ve=new fe,he=function(e){var t=e.profileId,a=Object(O.useDispatch)();Object(i.useEffect)((function(){var e;return a((e=t,{type:U.a.setProfileId,payload:e})),Object(ee.a)($.a.mark((function e(){var n;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(G(!0)),e.prev=1,e.next=4,ue.getProfileById({id:t,fields:"times,times.*,questions,questions.*,services, services.*,services.items.*,actions,actions.*,title"});case 4:n=e.sent,a(V(n||{})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a(z(e.t0));case 11:a(G(!1));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))(),function(){ue.cancel()}}),[])},Oe=function(e){var t=e.profileId,a=Object(O.useDispatch)(),n=Object(O.useSelector)((function(e){return p()(e,["calendar","startOfWeek"])})),r=Object(O.useSelector)((function(e){return p()(e,["calendar","endOfWeek"])})),c=Object(O.useSelector)((function(e){return p()(e,["calendar","needRefetch"])})),l=Object(i.useState)([]),s=Object(o.a)(l,2),u=s[0],d=s[1];return Object(i.useEffect)((function(){return Object(ee.a)($.a.mark((function e(){var c;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a(G(!0)),e.next=6,ve.getBookings({profileId:t,from:n,to:r});case 6:c=e.sent,d(c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),a(z(e.t0));case 13:a(G(!1));case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))(),function(){ve.cancel()}}),[r,c]),[u,d]},ye=a(41),Ee=function(){var e=Object(O.useSelector)((function(e){return p()(e,["calendar","error"])}));Object(i.useEffect)((function(){if(e){var t=(e||{}).message;t&&ye.toastr.error(x,t)}}),[e])},je=a(1433),ke=a(1414),xe=a(584),De=a(1445),Ce="SIMPLE",we="CHECKBOX",Se="MULTI_DROPDOWN",Ie=(n={},Object(c.a)(n,Ce,""),Object(c.a)(n,we,!1),Object(c.a)(n,Se,""),n),Le=function(e,t){return e.map((function(e){var a=e.code;return{code:a,string:t[a]}}))},Te=function(e){var t=e.appointmentData,a=e.values,n=e.config,r=n.title,c=n.questions,o=a.FNAME,i=a.appointmentType,l=t.startDate;return{title:"".concat(o," and ").concat(r),startsAt:k()(l).format("YYYY-MM-DDTHH:mm:ss"),tentative:"NOT_USED",timeZone:"Asia/Ho_Chi_Minh",cancelled:!1,units:1,services:[{id:i.id,name:i.name}],answers:Le(c,a)}},Ne=Object(f.a)((function(e){return{wrapper:Object(ce.a)(Object(ce.a)({},e.typography.h4),{},{padding:e.spacing(2,0),backgroundColor:e.palette.background.gray,textAlign:"center"})}})),Me=function(e){var t=e.appointmentData,a=t.startDate,n=t.endDate,r=Ne(),c=S({startDate:a,endDate:n}),o=c.displayDate,i=c.displayTime;return l.a.createElement("div",{className:r.wrapper},l.a.createElement(Y.a,{variant:"h4"},o),l.a.createElement(je.a,{sx:{mt:1}},l.a.createElement(Y.a,{variant:"h3"},i)))},qe=a(1530),Be=a.n(qe),Ye=a(1589),Ae=a(1575),Re=Object(f.a)((function(e){return{group:{width:"100%",margin:e.spacing(1,0,2,0)},button:{padding:e.spacing(1.5,2),textTransform:"none"},buttonLabel:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},duration:{display:"flex",alignItems:"center"},selected:{"&&, &&:hover":{backgroundColor:e.palette.primary.main}}}})),Fe=function(e){var t,a=e.appointmentTypes,n=Re(),r=Object(De.c)(),c=r.values,o=r.setFieldValue,i=(null===(t=c.appointmentType)||void 0===t?void 0:t.id)||"";return l.a.createElement(l.a.Fragment,null,l.a.createElement(Y.a,{variant:"h4"},"Choose an appointment type"),l.a.createElement(Ye.a,{orientation:"vertical",value:i,exclusive:!0,onChange:function(e,t){var n=a.find((function(e){return e.id===t}));o("appointmentType",n)},classes:{root:n.group}},a.map((function(e){return l.a.createElement(Ae.a,{value:e.id,classes:{root:n.button,label:n.buttonLabel,selected:n.selected},key:e.id},l.a.createElement(Y.a,{variant:"h5",color:"textPrimary"},e.name),l.a.createElement(Y.a,{variant:"subtitle1",classes:{root:n.duration}},l.a.createElement(Be.a,{fontSize:"small"}),l.a.createElement(je.a,{sx:{ml:.5,mt:.25}},function(e){var t=e.numberOfSlots,a=e.slotLengthMinutes;return"".concat(t*a," minutes")}(e))))}))))},Pe=a(1571),He=a(1569),We=a(1570),Ue=a(1588),Ve=Object(f.a)((function(e){return{textField:{marginTop:e.spacing(.5)},label:Object(ce.a)({color:e.palette.primary.dark},e.typography.h4),input:Object(ce.a)(Object(ce.a)({},e.typography.h5),{},{padding:e.spacing(1,1.5)})}})),ze=function(e){var t=Ve(),a=e.name,n=e.variant,r=e.placeholder,c=void 0===r?"":r,o=e.label,i=e.value,s=e.required,u=e.onChange,d=e.classes,m=void 0===d?{}:d;return l.a.createElement(He.a,{required:s},l.a.createElement(We.a,{color:"secondary",className:t.label},o),l.a.createElement(Ue.a,{name:a,variant:n,placeholder:c,value:i,onChange:u,classes:{root:Object(g.a)(t.textField,m.textField)},InputProps:{classes:{input:Object(g.a)(t.input,m.input)}}}))},Ge=Object(f.a)((function(e){return{after:Object(ce.a)({},e.typography.subtitle)}})),_e=a(1581),Je=a(1566),Ke=Object(f.a)((function(e){return{wrapper:{"& .MuiOutlinedInput-notchedOutline>legend>span":{display:"none"}},label:{"&&":Object(ce.a)({color:e.palette.primary.dark},e.typography.h4)},select:Object(ce.a)(Object(ce.a)({},e.typography.h5),{},{padding:e.spacing(1,1.5)}),item:Object(ce.a)({},e.typography.h5)}})),Xe=function(e){var t=Ke(),a=e.name,n=e.value,r=e.onChange,c=e.label,o=e.variant,i=e.required,s=e.options,u=e.classes,d=void 0===u?{}:u;return l.a.createElement(He.a,{required:i,classes:{root:t.wrapper}},l.a.createElement(We.a,{className:t.label},c),l.a.createElement(_e.a,{name:a,classes:{root:Object(g.a)(t.select,d.select)},value:n,onChange:r,label:"",variant:o,MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null}},l.a.createElement(Je.a,{classes:{root:Object(g.a)(t.item,d.item)},value:""},l.a.createElement("em",null,"None")),s.map((function(e){return l.a.createElement(Je.a,{key:e,value:e,classes:{root:Object(g.a)(t.item,d.item)}},e)}))))},Ze=a(1572),Qe=a(1584),$e=Object(f.a)((function(e){return{label:Object(ce.a)({},e.typography.h5),checkbox:{}}})),et=function(e){var t=$e(),a=e.name,n=e.required,r=e.checked,c=e.onChange,o=e.label,i=e.color,s=void 0===i?"primary":i,u=e.classes,d=void 0===u?{}:u;return l.a.createElement(He.a,{required:n},l.a.createElement(Ze.a,{classes:{label:Object(g.a)(t.label,d.label)},control:l.a.createElement(Qe.a,{classes:{root:Object(g.a)(t.checkbox,d.checkbox)},checked:r,onChange:c,name:a,color:s}),label:o}))},tt=Object(f.a)((function(e){return{after:Object(ce.a)({},e.typography.subtitle)}})),at=(r={},Object(c.a)(r,Ce,(function(e){var t=e.question,a=Ge(),n=t.code,r=t.before,c=t.after,o=t.required,i=Object(De.c)(),s=i.values,u=i.handleChange;return l.a.createElement(je.a,{sx:{display:"flex",flexDirection:"column",my:1}},l.a.createElement(ze,{name:n,variant:"outlined",placeholder:"",label:r,value:s[n],onChange:u,required:o}),Boolean(c)&&l.a.createElement(Pe.a,{className:a.after},c))})),Object(c.a)(r,we,(function(e){var t=e.question,a=tt(),n=t.after,r=t.before,c=t.required,o=t.code,i=Object(De.c)(),s=i.values,u=i.handleChange;return l.a.createElement(je.a,{sx:{display:"flex",flexDirection:"column",my:1}},l.a.createElement(et,{checked:s[o],onChange:u,name:o,color:"primary",label:r,required:c}),Boolean(n)&&l.a.createElement(Pe.a,{className:a.after},n))})),Object(c.a)(r,Se,(function(e){var t=e.question,a=t.code,n=t.after,r=t.before,c=t.required,o=t.options,i=void 0===o?[]:o,s=Object(De.c)(),u=s.values,d=s.handleChange;return l.a.createElement(je.a,{sx:{display:"flex",flexDirection:"column",my:1}},l.a.createElement(Xe,{name:a,value:u[a],onChange:d,label:r,variant:"outlined",required:c,options:i}),Boolean(n)&&l.a.createElement(je.a,{sx:{mt:1}},n))})),r),nt=function(e){var t=e.questions;return l.a.createElement(l.a.Fragment,null,t.map((function(e){var t=at[e.type];return l.a.createElement(t,{key:e.code,question:e})})))},rt=Object(y.a)({profileId:function(e){return p()(e,"calendar.profileId")},config:function(e){return p()(e,"calendar.config")}}),ct={setIsLoading:G,setError:z,setNeedRefetch:function(e){return{type:U.a.setNeedRefetch,payload:e}}},ot=Object(O.connect)(rt,ct)(Object(E.a)((function(e){var t=e.profileId,a=e.config,n=e.appointmentData,r=e.setIsLoading,o=e.setError,i=e.setNeedRefetch,s=p()(a,"questions",[]),u=p()(a,"services.items",[]),d=function(e){return e.reduce((function(e,t){var a=t.code,n=t.type;return Object(ce.a)(Object(ce.a)({},e),{},Object(c.a)({},a,Ie[n]))}),{appointmentType:void 0})}(s),m=function(){var e=Object(ee.a)($.a.mark((function e(c){var l;return $.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),l=Te({appointmentData:n,values:c,config:a}),e.next=5,ve.createBooking({profileId:t,data:l});case 5:i(!0),r(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),r(!1),o(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return l.a.createElement(je.a,{sx:{display:"flex",flexDirection:"column"}},l.a.createElement(De.b,{initialValues:d,onSubmit:m},l.a.createElement(De.a,null,l.a.createElement(Fe,{appointmentTypes:u}),l.a.createElement(Me,{appointmentData:n}),l.a.createElement(ke.a,null),l.a.createElement(je.a,{sx:{mt:4}},l.a.createElement(nt,{questions:s})),l.a.createElement(xe.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained"},"Confirm Booking"))))}))),it=function(e){var t=e.appointmentData;return i.createElement(ot,{appointmentData:t})},lt=["basicLayoutComponent","commandLayoutComponent","recurrenceLayoutComponent","isRecurrence","children"],st=Object(f.a)((function(e){return{layout:{background:e.palette.common.white},content:{padding:e.spacing(4)}}})),ut=function(e){var t=e.basicLayoutComponent,a=(e.commandLayoutComponent,e.recurrenceLayoutComponent),n=(e.isRecurrence,e.children),r=Object(N.a)(e,lt),c=st();return l.a.createElement("div",Object.assign({className:c.layout},r),l.a.createElement("div",{className:c.content},l.a.createElement(t,null),l.a.createElement(a,null)),n)},dt=function(){return l.a.createElement(d.a,{layoutComponent:ut,basicLayoutComponent:it})},mt=Object(f.a)((function(e){return{container:{minHeight:"100px",marginBottom:e.spacing(3),padding:e.spacing(3),fontFamily:e.typography.fontFamily.avenirLT},loading:{border:"1px solid #E0E0E0",backgroundColor:e.palette.common.white}}})),pt=Object(y.a)({config:function(e){return p()(e,["calendar","config"])},isLoading:function(e){return p()(e,["calendar","isLoading"])}});t.default=Object(O.connect)(pt,void 0)(Object(E.a)((function(e){var t=e.config,a=e.profileId,n=e.isLoading,r=mt();he({profileId:a});var i=Oe({profileId:a}),m=Object(o.a)(i,1)[0];return Ee(),W()(t)&&!n?l.a.createElement(l.a.Fragment,null):l.a.createElement(Z.a,{tag:"div",blocking:n,loader:l.a.createElement(X.Loader,{active:!0,type:"ball-pulse",color:"rgba(231,28,99,1)"}),className:Object(g.a)(r.container,Object(c.a)({},r.loading,n))},l.a.createElement(s.a,{elevation:3},l.a.createElement(d.e,{data:m},l.a.createElement(u.r,null),l.a.createElement(d.h,{timeTableCellComponent:T,dayScaleCellComponent:h,cellDuration:p()(t,"times.slotLengthMinutes")||60}),l.a.createElement(u.k,null),l.a.createElement(K,null),l.a.createElement(d.g,null),l.a.createElement(d.d,null),l.a.createElement(d.f,null),l.a.createElement(d.c,{appointmentComponent:B}),l.a.createElement(d.b,{showCloseButton:!0,contentComponent:P}),l.a.createElement(dt,null))))})))}}]);
//# sourceMappingURL=16.2fcc714f.chunk.js.map