(this.webpackJsonpnilehome=this.webpackJsonpnilehome||[]).push([[16],{1602:function(e,t,a){"use strict";a.r(t);var n,r,c=a(80),o=a(0),i=a.n(o),l=a(409),s=a(1487),u=a(1461),m=a(19),p=a.n(m),d=a(1365),f=a(59),b=a(24),v=Object(d.a)((function(e){return{cell:{paddingTop:e.spacing(1)},today:{backgroundColor:Object(f.a)(e.palette.primary.main,.16)}}})),g=function(e){var t=v(),a=e.today;return o.createElement(u.h.DayScaleCell,Object.assign({},e,{className:Object(b.a)(t.cell,Object(c.a)({},t.today,a))}))},y=a(4),O=a(136),h=a(163),E=a(164),j=a(174),k=a.n(j),D=(a(1491),a(1)),x="Something went wrong",C="".concat("YYYY-MM-DD"," ").concat("HH:mm:ss"),w=function(e){var t=e.config,a=e.dateString,n=e.key,r=p()(t,n);if(!r)return"";var c=p()(t,"timeZone");return Y("".concat(a," ").concat(r),c)},S=function(e){var t=e.dateString,a=e.config,n=function(e){return new Date(e).toLocaleString("en-us",{weekday:"short"}).toLowerCase()}(t),r=k()(t);if(function(e){return k()().diff(e,"hours")>0}(r))return!1;if(!function(e){var t=e.dateName,a=e.config;return p()(a,"".concat(t,"Active"))||!1}({dateName:n,config:a}))return!1;var c=r.format("YYYY-MM-DD");return!!function(e){var t=e.config,a=e.currentMoment,n=e.currentDate,r=e.dateName,c=w({config:t,dateString:n,key:"".concat(r,"Start")}),o=w({config:t,dateString:n,key:"".concat(r,"End")});return I({start:c,end:o,current:a})}({config:a,currentMoment:r,currentDate:c,dateName:n})&&!function(e){var t=e.config,a=e.currentMoment,n=e.currentDate,r=w({config:t,dateString:n,key:"breakStart"}),c=w({config:t,dateString:n,key:"breakEnd"});return I({start:r,end:c,current:a})}({config:a,currentMoment:r,currentDate:c})},L=function(e){var t=e.startDate,a=e.endDate;return{displayDate:k()(t).format("dddd, MMMM DD, YYYY"),displayTime:"".concat(k()(t).format("hh:mm A")," - ").concat(k()(a).format("hh:mm A"))}},T=function(e){var t=e.services.find((function(e){return e.name.toLowerCase()===D.n}));return Boolean(t)},Y=function(e,t){return t?k.a.tz(e,t).local().format(C):k()(e).format(C)},I=function(e){var t=e.start,a=e.end,n=e.current;if(!t||!a||!n)return!1;var r=k()(k()(t).format("HH:mm:ss"),"HH:mm:ss"),c=k()(k()(a).format("HH:mm:ss"),"HH:mm:ss"),o=k()(k()(n).format("HH:mm:ss"),"HH:mm:ss");return r.isAfter(c)&&(c.add(1,"days"),o.hour()<=12&&o.add(1,"days")),o.isSameOrAfter(r)&&o.isBefore(c)},M=Object(d.a)((function(e){return{disableCell:{background:"linear-gradient(-45deg,".concat(e.palette.action.disabledBackground," 10%,transparent 10%,transparent 50%,").concat(e.palette.action.disabledBackground," 50%,").concat(e.palette.action.disabledBackground," 60%,transparent 60%,transparent)"),backgroundSize:"8px 8px",pointerEvents:"none"}}})),B=Object(h.a)({timeConfig:function(e){return Object(y.a)(Object(y.a)({},p()(e,"calendar.config.times")),{},{timeZone:p()(e,"calendar.config.timeZone")})}}),N=Object(O.connect)(B,void 0)(Object(E.a)((function(e){var t=M(),a=e.startDate,n=e.timeConfig;return o.createElement(u.h.TimeTableCell,Object.assign({},e,{className:Object(b.a)(Object(c.a)({},t.disableCell,!S({dateString:a,config:n})))}))}))),A=a(276),q=a(190),H=a.n(q),F=a(242),P=["property","children"],R=Object(d.a)((function(e){return{appointment:{padding:e.spacing(.5,1),backgroundColor:e.palette.primary.main,color:e.palette.common.white,"&:hover":{backgroundColor:e.palette.primary.main}},busy:{backgroundColor:e.palette.common.lightGray,color:e.palette.primary.gray,"&:hover":{backgroundColor:e.palette.common.lightGray}},title:{overflow:"hidden",fontWeight:"bold",whiteSpace:"nowrap",textOverflow:"ellipsis"}}})),z=Object(h.a)({property:function(e){return H()(e,["calendar","property"])}}),W=Object(O.connect)(z)((function(e){var t=e.property,a=(e.children,Object(A.a)(e,P)),n=a.data,r=R(),i=!t,l=T(n),s=n.title,m=L(n).displayTime;return o.createElement(u.c.Appointment,Object.assign({},a,{className:Object(b.a)(r.appointment,Object(c.a)({},r.busy,l))}),i&&T(n)?o.createElement("div",null,"Busy"):o.createElement("div",null,o.createElement(F.a,{variant:"subtitle1",classes:{root:r.title}},s),o.createElement(F.a,{variant:"subtitle1"},m)))})),V=a(1598),G=a(1599),U=a(1445),Z=Object(d.a)((function(e){return{wrapper:{padding:e.spacing(2),paddingTop:0},section:{marginBottom:e.spacing(1)},busy:{color:e.palette.primary.gray}}})),K=Object(h.a)({isBuyer:function(e){return!p()(e,["calendar","property"])}}),_=Object(O.connect)(K)((function(e){var t=e.appointmentData,a=e.isBuyer,n=Z(),r=L(t),i=r.displayDate,s=r.displayTime,u=a&&T(t);return o.createElement(l.a,{className:n.wrapper},o.createElement(F.a,{variant:"h4",color:"primary",className:Object(b.a)(n.section,Object(c.a)({},n.busy,u))},u?"Busy":p()(t,"title","")),o.createElement(U.a,{sx:{mb:1,display:"flex",alignItems:"center"}},o.createElement(U.a,{sx:{mr:.5,display:"flex"}},o.createElement(V.a,{fontSize:"small"})),o.createElement(F.a,{variant:"h5"},i)),o.createElement(U.a,{sx:{mb:1,display:"flex",alignItems:"center"}},o.createElement(U.a,{sx:{mr:.5,display:"flex"}},o.createElement(G.a,{fontSize:"small"})),o.createElement(F.a,{variant:"h5"},s)))})),J=a(60),X=a.n(J),Q=a(414),$=a(1464),ee={setStartOfWeek:Q.i,setEndOfWeek:Q.d},te=Object(O.connect)(void 0,ee)(Object(E.a)((function(e){var t=e.setStartOfWeek,a=e.setEndOfWeek;return i.a.createElement($.f,{name:"IntegratedDates"},i.a.createElement($.e,{name:"startViewDate",computed:function(e){var a=e.startViewDate;return t(a),a}}),i.a.createElement($.e,{name:"endViewDate",computed:function(e){var t=e.endViewDate;return a(t),t}}))}))),ae=a(127),ne=a(111),re=a(10),ce=a.n(re),oe=a(28),ie=a(9),le=a(12),se=a(14),ue=a(13),me=a(97),pe=a.n(me),de=a(417),fe=function(){function e(){Object(ie.a)(this,e),this.baseURL="".concat("https://api.youcanbook.me/v1","/").concat("dc7ded13-f988-4671-b5d1-142c6096066e","/"),this.cancelToken=null}return Object(le.a)(e,[{key:"cancel",value:function(){null!==this.cancelToken&&this.cancelToken()}},{key:"axios",value:function(e){var t=e.method,a=e.baseURL,n=void 0===a?this.baseURL:a,r=e.url,c=e.data,o=e.params,i=e.headers,l=void 0===i?{}:i,s=e.needResHeaders,u=void 0!==s&&s,m=this,d=pe.a.CancelToken;return new Promise((function(e,a){var i={method:t,url:r,baseURL:n,timeout:3e4,params:o,data:c,headers:Object(y.a)(Object(y.a)({},l),{},{Authorization:de.c}),cancelToken:new d((function(e){m.cancelToken=e}))};pe.a.request(i).then((function(t){var a="object"===typeof t.data?t.data:JSON.parse(t.data);e(u?{data:a,headers:t.headers}:a)}),(function(e){var t=p()(e,["response","status"]),n=p()(e,["response","data","message"]),r=p()(e,["response","data","errors"]);a({status:t,message:n,errors:r})}))}))}}]),e}(),be=new(function(e){Object(se.a)(a,e);var t=Object(ue.a)(a);function a(){return Object(ie.a)(this,a),t.apply(this,arguments)}return Object(le.a)(a,[{key:"getProfileById",value:function(e){var t=e.id,a=e.fields;return t?this.axios({method:"GET",url:"".concat(de.b.PROFILES,"/").concat(t),params:{fields:a}}):{}}}]),a}(fe)),ve=a(130),ge=a(1550),ye=a.n(ge),Oe=function(e){var t=p()(e,["answers"],[]).filter((function(e){return"EMAIL"===e.code}))[0];return p()(t,"string","")},he=function(e){return!e.cancelled},Ee=function(e){return e.map((function(e){return function(e){var t=p()(e,"startsAt"),a=p()(e,"endsAt"),n=p()(e,"timeZone");return{title:Oe(e),id:p()(e,"id"),startDate:Y(t,n),endDate:Y(a,n),services:p()(e,"services",[]),cancelled:p()(e,"cancelled")}}(e)})).filter(he)},je=new(function(e){Object(se.a)(a,e);var t=Object(ue.a)(a);function a(){return Object(ie.a)(this,a),t.apply(this,arguments)}return Object(le.a)(a,[{key:"createBooking",value:function(){var e=Object(oe.a)(ce.a.mark((function e(t){var a,n,r;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.profileId,n=t.data,e.next=3,this.axios({method:"POST",url:"".concat(de.b.PROFILES,"/").concat(a,"/").concat(de.b.BOOKINGS),params:{fields:de.a},data:Object(y.a)({},n)});case 3:return r=e.sent,e.abrupt("return",Ee([r]));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createBookings",value:function(){var e=Object(oe.a)(ce.a.mark((function e(t){var a,n,r,c,o,i;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.profileId,n=t.data,r=0,c=[],o=[];case 4:if(r===n.length){e.next=18;break}return e.prev=5,e.next=8,this.axios({method:"POST",url:"".concat(de.b.PROFILES,"/").concat(a,"/").concat(de.b.BOOKINGS),params:{fields:de.a},data:n[r]});case 8:i=e.sent,o.push(i),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),c.push(n[r]);case 15:r+=1,e.next=4;break;case 18:return e.abrupt("return",{bookings:Ee(o),errors:c});case 19:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getBookings",value:function(){var e=Object(oe.a)(ce.a.mark((function e(t){var a,n,r,c,o,i,l,s,u,m;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.profileId,n=t.from,r=t.to,a){e.next=3;break}return e.abrupt("return",[]);case 3:c=!0,o="",i=[];case 6:if(!c){e.next=25;break}if(o){e.next=13;break}return e.next=10,this.axios({method:"GET",url:"".concat(de.b.PROFILES,"/").concat(a,"/").concat(de.b.BOOKINGS),params:{fields:de.a,jumpToDate:k()(n).format("YYYY-MM-DD")},needResHeaders:!0});case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,this.axios({method:"GET",url:o,needResHeaders:!0});case 15:e.t0=e.sent;case 16:l=e.t0,s=p()(l,["headers","link"],""),o=p()(ye()(s),["next","url"],""),u=p()(l,["data"]),i=[].concat(Object(ve.a)(i),Object(ve.a)(u)),m=p()(u,[u.length-1,"startsAt"],""),c=o&&k()(m).isBefore(r),e.next=6;break;case 25:return e.abrupt("return",Ee(i));case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),a}(fe)),ke=function(e){var t=e.profileId,a=Object(O.useDispatch)();Object(o.useEffect)((function(){return a(Object(Q.g)(t)),Object(oe.a)(ce.a.mark((function e(){var n;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(Object(Q.f)(!0)),e.prev=1,e.next=4,be.getProfileById({id:t,fields:"times,times.*,questions,questions.*,services, services.*,services.items.*,actions,actions.*,title,timeZone"});case 4:n=e.sent,a(Object(Q.c)(n||{})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a(Object(Q.e)(e.t0));case 11:a(Object(Q.f)(!1));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))(),function(){be.cancel()}}),[t])},De=function(e){var t=e.profileId,a=Object(O.useDispatch)(),n=Object(O.useSelector)((function(e){return p()(e,["calendar","startOfWeek"])})),r=Object(O.useSelector)((function(e){return p()(e,["calendar","endOfWeek"])}));Object(o.useEffect)((function(){return Object(oe.a)(ce.a.mark((function e(){var c;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,a(Object(Q.f)(!0)),e.next=6,je.getBookings({profileId:t,from:n,to:r});case 6:c=e.sent,a(Object(Q.b)(c)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),a(Object(Q.e)(e.t0));case 13:a(Object(Q.f)(!1));case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))(),function(){je.cancel()}}),[r,t])},xe=a(39),Ce=function(){var e=Object(O.useSelector)((function(e){return p()(e,["calendar","error"])}));Object(o.useEffect)((function(){if(e){var t=(e||{}).message;t&&xe.toastr.error(x,t)}}),[e])},we=a(62),Se=a(1424),Le=a(591),Te=a(1457),Ye=a(66),Ie="SIMPLE",Me="CHECKBOX",Be="MULTI_DROPDOWN",Ne=(n={},Object(c.a)(n,Ie,""),Object(c.a)(n,Me,!1),Object(c.a)(n,Be,""),n),Ae="daily",qe="weekly",He=function(e){return e.reduce((function(e,t){var a=t.code,n=t.type;return Object(y.a)(Object(y.a)({},e),{},Object(c.a)({},a,Ne[n]))}),{appointmentType:void 0})},Fe=function(e,t){return e.map((function(e){var a=e.code;return{code:a,string:t[a]}})).filter((function(e){return e.string}))},Pe=function(e){var t=e.appointmentData,a=e.values,n=e.config,r=n.title,c=n.questions,o=a.FNAME,i=a.appointmentType,l=t.startDate;return{title:"".concat(o," and ").concat(r),startsAt:k()(l).format("YYYY-MM-DDTHH:mm:ss"),tentative:"NOT_USED",timeZone:k.a.tz.guess(),cancelled:!1,units:1,services:[{id:i.id,name:i.name}],answers:Fe(c,a)}},Re=function(e){var t=e.appointmentData,a=e.values,n=e.config,r=n.questions,c=t.startDate,o=a.repeat,i=a.repeatType,l=a.startDate,s=a.endDate,u=function(e){return e.find((function(e){return"busy"===e.name.toLowerCase()}))}(H()(n,"services.items",[]));if(!o)return[{title:"busy",startsAt:k()(c).format("YYYY-MM-DDTHH:mm:ss"),tentative:"NOT_USED",timeZone:k.a.tz.guess(),cancelled:!1,units:1,services:[u],answers:Fe(r,a)}];var m=k()(c).format("HH:mm:ss"),p=k()(l),d=k()(s).diff(p,"day"),f=i===qe?7:1;return Array.from(Array(Math.floor(d/f)+1),(function(e,t){return t*f})).map((function(e){var t=k()(l).add(e,"day");return{title:"busy",startsAt:"".concat(t.format("YYYY-MM-DD"),"T").concat(m),tentative:"NOT_USED",timeZone:k.a.tz.guess(),cancelled:!1,units:1,services:[u],answers:Fe(r,a)}}))},ze=function(e){var t=e.map((function(e){return e.startsAt})).join(", ");return{message:"Cannot book at dates: ".concat(t)}},We=Object(d.a)((function(e){return{wrapper:Object(y.a)(Object(y.a)({},e.typography.h4),{},{padding:e.spacing(2,0),backgroundColor:e.palette.background.gray,textAlign:"center"})}})),Ve=function(e){var t=e.appointmentData,a=t.startDate,n=t.endDate,r=We(),c=L({startDate:a,endDate:n}),o=c.displayDate,l=c.displayTime;return i.a.createElement("div",{className:r.wrapper},i.a.createElement(F.a,{variant:"h4"},o),i.a.createElement(U.a,{sx:{mt:1}},i.a.createElement(F.a,{variant:"h3"},l)))},Ge=a(1555),Ue=a.n(Ge),Ze=a(1450),Ke=a(1441),_e=Object(d.a)((function(e){return{group:{width:"100%",margin:e.spacing(1,0,2,0)},button:{padding:e.spacing(1.5,2),textTransform:"none"},buttonLabel:{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},duration:{display:"flex",alignItems:"center"},selected:{"&&, &&:hover":{backgroundColor:e.palette.primary.main}}}})),Je=function(e){var t=e.appointmentTypes,a=_e(),n=Object(Te.c)(),r=n.values,c=n.setFieldValue,l=H()(r,"appointmentType.id")||"";Object(o.useEffect)((function(){if(1===t.length){var e=Object(we.a)(t,1)[0];c("appointmentType",e)}}),[t.length]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(F.a,{variant:"h4"},"Choose an appointment type"),i.a.createElement(Ze.a,{orientation:"vertical",value:l,exclusive:!0,onChange:function(e,a){var n=t.find((function(e){return e.id===a}));c("appointmentType",n)},classes:{root:a.group}},t.map((function(e){return i.a.createElement(Ke.a,{value:e.id,classes:{root:a.button,label:a.buttonLabel,selected:a.selected},key:e.id},i.a.createElement(F.a,{variant:"h5",color:"textPrimary"},e.name),i.a.createElement(F.a,{variant:"subtitle1",classes:{root:a.duration}},i.a.createElement(Ue.a,{fontSize:"small"}),i.a.createElement(U.a,{sx:{ml:.5,mt:.25}},function(e){var t=e.numberOfSlots,a=e.slotLengthMinutes;return"".concat(t*a," minutes")}(e))))}))))},Xe=a(1595),Qe=a(1593),$e=a(1594),et=a(1616),tt=Object(d.a)((function(e){return{textField:{marginTop:e.spacing(.5)},label:Object(y.a)({color:e.palette.primary.dark},e.typography.h4),input:Object(y.a)(Object(y.a)({},e.typography.h5),{},{padding:e.spacing(1,1.5)})}})),at=function(e){var t=tt(),a=e.name,n=e.variant,r=e.placeholder,c=void 0===r?"":r,o=e.label,l=e.value,s=e.required,u=e.onChange,m=e.classes,p=void 0===m?{}:m;return i.a.createElement(Qe.a,{required:s},i.a.createElement($e.a,{color:"secondary",className:t.label},o),i.a.createElement(et.a,{name:a,variant:n,placeholder:c,value:l,onChange:u,classes:{root:Object(b.a)(t.textField,p.textField)},InputProps:{classes:{input:Object(b.a)(t.input,p.input)}}}))},nt=Object(d.a)((function(e){return{after:Object(y.a)({},e.typography.subtitle)}})),rt=a(1607),ct=a(1589),ot=Object(d.a)((function(e){return{wrapper:{"& .MuiOutlinedInput-notchedOutline>legend>span":{display:"none"}},label:{"&&":Object(y.a)({color:e.palette.primary.dark},e.typography.h4)},select:Object(y.a)(Object(y.a)({},e.typography.h5),{},{padding:e.spacing(1,1.5)}),item:Object(y.a)({},e.typography.h5)}})),it=function(e){var t=ot(),a=e.name,n=e.value,r=e.onChange,c=e.label,o=e.variant,l=e.required,s=e.options,u=e.classes,m=void 0===u?{}:u;return i.a.createElement(Qe.a,{required:l,classes:{root:t.wrapper}},i.a.createElement($e.a,{className:t.label},c),i.a.createElement(rt.a,{name:a,classes:{root:Object(b.a)(t.select,m.select)},value:n,onChange:r,label:"",variant:o,MenuProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},getContentAnchorEl:null}},i.a.createElement(ct.a,{classes:{root:Object(b.a)(t.item,m.item)},value:""},i.a.createElement("em",null,"None")),s.map((function(e){return i.a.createElement(ct.a,{key:e,value:e,classes:{root:Object(b.a)(t.item,m.item)}},e)}))))},lt=a(1597),st=a(1611),ut=Object(d.a)((function(e){return{label:Object(y.a)({},e.typography.h5),checkbox:{}}})),mt=function(e){var t=ut(),a=e.name,n=e.required,r=e.checked,c=e.onChange,o=e.label,l=e.color,s=void 0===l?"primary":l,u=e.classes,m=void 0===u?{}:u;return i.a.createElement(Qe.a,{required:n},i.a.createElement(lt.a,{classes:{label:Object(b.a)(t.label,m.label)},control:i.a.createElement(st.a,{classes:{root:Object(b.a)(t.checkbox,m.checkbox)},checked:r,onChange:c,name:a,color:s}),label:o}))},pt=Object(d.a)((function(e){return{after:Object(y.a)({},e.typography.subtitle)}})),dt=(r={},Object(c.a)(r,Ie,(function(e){var t=e.question,a=nt(),n=t.code,r=t.before,c=t.after,o=t.required,l=Object(Te.c)(),s=l.values,u=l.handleChange;return i.a.createElement(U.a,{sx:{display:"flex",flexDirection:"column",my:1}},i.a.createElement(at,{name:n,variant:"outlined",placeholder:"",label:r,value:s[n],onChange:u,required:o}),Boolean(c)&&i.a.createElement(Xe.a,{className:a.after},c))})),Object(c.a)(r,Me,(function(e){var t=e.question,a=pt(),n=t.after,r=t.before,c=t.required,o=t.code,l=Object(Te.c)(),s=l.values,u=l.handleChange;return i.a.createElement(U.a,{sx:{display:"flex",flexDirection:"column",my:1}},i.a.createElement(mt,{checked:s[o],onChange:u,name:o,color:"primary",label:r,required:c}),Boolean(n)&&i.a.createElement(Xe.a,{className:a.after},n))})),Object(c.a)(r,Be,(function(e){var t=e.question,a=t.code,n=t.after,r=t.before,c=t.required,o=t.options,l=void 0===o?[]:o,s=Object(Te.c)(),u=s.values,m=s.handleChange;return i.a.createElement(U.a,{sx:{display:"flex",flexDirection:"column",my:1}},i.a.createElement(it,{name:a,value:u[a],onChange:m,label:r,variant:"outlined",required:c,options:l}),Boolean(n)&&i.a.createElement(U.a,{sx:{mt:1}},n))})),r),ft=function(e){var t=e.questions;return i.a.createElement(i.a.Fragment,null,t.map((function(e){var t=dt[e.type];return t?i.a.createElement(t,{key:e.code,question:e}):i.a.createElement(i.a.Fragment,null)})))},bt=Object(h.a)({profileId:function(e){return p()(e,"calendar.profileId")},config:function(e){return p()(e,"calendar.config")},isLoading:function(e){return p()(e,"calendar.isLoading")}}),vt={setIsLoading:Q.f,setError:Q.e,addAppointments:Q.a},gt=Object(O.connect)(bt,vt)(Object(E.a)((function(e){var t=e.profileId,a=e.config,n=e.appointmentData,r=e.setIsLoading,c=e.setError,o=e.addAppointments,l=e.onSave,s=e.isLoading,u=p()(a,"questions",[]),m=p()(a,"services.items",[]).filter((function(e){return e.name.toLowerCase()!==D.n})),d=He(u),f=function(){var e=Object(oe.a)(ce.a.mark((function e(i){var s,u;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),s=Pe({appointmentData:n,values:i,config:a}),e.next=5,je.createBooking({profileId:t,data:s});case 5:u=e.sent,o(u),l(),r(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),r(!1),c(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return i.a.createElement(U.a,{sx:{display:"flex",flexDirection:"column"}},i.a.createElement(Te.b,{initialValues:d,onSubmit:f},i.a.createElement(Te.a,null,i.a.createElement(Je,{appointmentTypes:m}),i.a.createElement(Ve,{appointmentData:n}),i.a.createElement(Se.a,null),i.a.createElement(U.a,{sx:{mt:4}},i.a.createElement(ft,{questions:u})),i.a.createElement(Le.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained",disabled:s},"Confirm Booking"))))}))),yt=a(1489),Ot=a(1600),ht=a(1416),Et=a(1617),jt=a(1608),kt=a(1421),Dt=a(1456),xt=a(1601),Ct=function(){var e=Object(Te.c)(),t=e.values,a=e.handleChange,n=e.setFieldValue,r=function(e){return function(t){n(e,k()(t).format("MM/DD/YYYY"))}};return i.a.createElement("div",null,i.a.createElement(lt.a,{control:i.a.createElement(Ot.a,{name:"repeat",checked:t.repeat,onChange:a,color:"primary"}),label:"Repeat"}),i.a.createElement(ht.a,{in:t.repeat},i.a.createElement("div",null,i.a.createElement(Et.a,{name:"repeatType",value:t.repeatType,onChange:a},i.a.createElement(lt.a,{value:"daily",control:i.a.createElement(jt.a,{color:"primary"}),label:"Daily"}),i.a.createElement(lt.a,{value:"weekly",control:i.a.createElement(jt.a,{color:"primary"}),label:"Weekly"}))),i.a.createElement(kt.a,{container:!0,justifyContent:"space-between"},i.a.createElement(Dt.a,{utils:yt.a},i.a.createElement(xt.a,{disableToolbar:!0,inputVariant:"outlined",format:"MM/DD/YYYY",margin:"normal",label:"Start date",value:new Date(t.startDate),onChange:r("startDate")}),i.a.createElement(xt.a,{disableToolbar:!0,inputVariant:"outlined",format:"MM/DD/YYYY",margin:"normal",label:"End date",value:new Date(t.endDate),onChange:r("endDate")})))))},wt=Object(h.a)({profileId:function(e){return p()(e,"calendar.profileId")},config:function(e){return p()(e,"calendar.config")},property:function(e){return p()(e,"calendar.property")},isLoading:function(e){return p()(e,"calendar.isLoading")}}),St={setIsLoading:Q.f,setError:Q.e,addAppointments:Q.a},Lt=Object(O.connect)(wt,St)(Object(E.a)((function(e){var t=e.profileId,a=e.config,n=e.appointmentData,r=e.setIsLoading,c=e.setError,o=e.addAppointments,l=e.property,s=e.onSave,u=e.isLoading,m=function(e){var t=e.property,a=e.appointmentData,n=e.config.questions,r=a.startDate,c=k()(r).format("MM/DD/YYYY"),o=H()(t,"PropertyData.FullAddress",""),i=H()(Ye.a,["user","attributes","email"],"");return Object(y.a)(Object(y.a)({},He(n)),{},{FNAME:o,EMAIL:i,repeat:!1,repeatType:Ae,startDate:c,endDate:c})}({property:l,appointmentData:n,config:a}),p=function(){var e=Object(oe.a)(ce.a.mark((function e(i){var l,u,m,p;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),l=Re({appointmentData:n,values:i,config:a}),e.next=5,je.createBookings({profileId:t,data:l});case 5:u=e.sent,m=u.bookings,p=u.errors,X()(p)||c(ze(p)),o(m),s(),r(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),r(!1),c(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}();return i.a.createElement(U.a,{sx:{display:"flex",flexDirection:"column"}},i.a.createElement(Te.b,{initialValues:m,onSubmit:p},i.a.createElement(Te.a,null,i.a.createElement(U.a,{sx:{mb:2}},i.a.createElement(F.a,{variant:"h4"},"Block available slots")),i.a.createElement(Ve,{appointmentData:n}),i.a.createElement(Se.a,null),i.a.createElement(U.a,{sx:{my:2}},i.a.createElement(Ct,null)),i.a.createElement(Le.a,{type:"submit",color:"primary",disableElevation:!0,fullWidth:!0,variant:"contained",disabled:u},"Confirm Booking"))))}))),Tt=Object(h.a)({property:function(e){return H()(e,["calendar","property"])}}),Yt=Object(O.connect)(Tt)(Object(E.a)((function(e){var t=e.appointmentData,a=e.property,n=e.onSave,r=a?Lt:gt;return o.createElement(r,{appointmentData:t,onSave:n})}))),It=["basicLayoutComponent","commandLayoutComponent","recurrenceLayoutComponent","isRecurrence","children"],Mt=Object(d.a)((function(e){return{layout:{background:e.palette.common.white},content:{padding:e.spacing(4)}}})),Bt=function(e){var t=e.basicLayoutComponent,a=e.commandLayoutComponent,n=e.recurrenceLayoutComponent,r=(e.isRecurrence,e.children),c=Object(A.a)(e,It),o=Mt();return i.a.createElement("div",Object.assign({className:o.layout},c),i.a.createElement(a,null),i.a.createElement("div",{className:o.content},i.a.createElement(t,null),i.a.createElement(n,null)),r)},Nt=function(e){var t=e.onCommitButtonClick,a=e.isSaving,n=e.setIsSaving;return Object(o.useEffect)((function(){a&&(t(),n(!1))}),[a]),i.a.createElement("div",null)},At=function(){var e=Object(o.useState)(!1),t=Object(we.a)(e,2),a=t[0],n=t[1],r=Object($.k)(Yt,(function(){return{onSave:function(){return n(!0)}}})),c=Object($.k)(Nt,(function(){return{isSaving:a,setIsSaving:n}}));return i.a.createElement(u.a,{layoutComponent:Bt,basicLayoutComponent:r,commandLayoutComponent:c})},qt=Object(d.a)((function(e){return{container:{minHeight:"100px",fontFamily:e.typography.fontFamily.avenirLT},loading:{border:"1px solid #E0E0E0",backgroundColor:e.palette.common.white}}})),Ht=Object(h.a)({config:function(e){return p()(e,["calendar","config"])},isLoading:function(e){return p()(e,["calendar","isLoading"])},appointments:function(e){return p()(e,["calendar","appointments"])}});t.default=Object(O.connect)(Ht,void 0)(Object(E.a)((function(e){var t=e.config,a=e.profileId,n=e.isLoading,r=e.appointments,o=qt();ke({profileId:a}),De({profileId:a}),Ce();return X()(t)&&!n?i.a.createElement(i.a.Fragment,null):i.a.createElement(ne.a,{tag:"div",blocking:n,loader:i.a.createElement(ae.Loader,{active:!0,type:"ball-pulse",color:"rgba(231,28,99,1)"}),className:Object(b.a)(o.container,Object(c.a)({},o.loading,n))},i.a.createElement(l.a,{elevation:3},i.a.createElement(u.e,{data:r},i.a.createElement(s.r,null),i.a.createElement(u.h,{timeTableCellComponent:N,dayScaleCellComponent:g,cellDuration:p()(t,"times.slotLengthMinutes")||60}),i.a.createElement(s.k,{onCommitChanges:function(){}}),i.a.createElement(te,null),i.a.createElement(u.g,null),i.a.createElement(u.d,null),i.a.createElement(u.f,null),i.a.createElement(u.c,{appointmentComponent:W}),i.a.createElement(u.b,{showCloseButton:!0,contentComponent:_}),i.a.createElement(At,null))))})))}}]);
//# sourceMappingURL=16.5e817d38.chunk.js.map